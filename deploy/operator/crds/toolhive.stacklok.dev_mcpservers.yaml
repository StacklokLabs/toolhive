---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.3
  name: mcpservers.toolhive.stacklok.dev
spec:
  group: toolhive.stacklok.dev
  names:
    kind: MCPServer
    listKind: MCPServerList
    plural: mcpservers
    singular: mcpserver
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.phase
      name: Status
      type: string
    - jsonPath: .status.url
      name: URL
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: MCPServer is the Schema for the mcpservers API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: MCPServerSpec defines the desired state of MCPServer
            properties:
              args:
                description: Args are additional arguments to pass to the MCP server
                items:
                  type: string
                type: array
              env:
                description: Env are environment variables to set in the MCP server
                  container
                items:
                  description: EnvVar represents an environment variable in a container
                  properties:
                    name:
                      description: Name of the environment variable
                      type: string
                    value:
                      description: Value of the environment variable
                      type: string
                  required:
                  - name
                  - value
                  type: object
                type: array
              image:
                description: Image is the container image for the MCP server
                type: string
              permissionProfile:
                description: PermissionProfile defines the permission profile to use
                properties:
                  key:
                    description: |-
                      Key is the key in the ConfigMap that contains the permission profile
                      Only used when Type is "configmap"
                    type: string
                  name:
                    description: |-
                      Name is the name of the permission profile
                      If Type is "builtin", Name must be one of: "none", "network"
                      If Type is "configmap", Name is the name of the ConfigMap
                    type: string
                  type:
                    default: builtin
                    description: Type is the type of permission profile reference
                    enum:
                    - builtin
                    - configmap
                    type: string
                required:
                - name
                - type
                type: object
              port:
                default: 8080
                description: Port is the port to expose the MCP server on
                format: int32
                maximum: 65535
                minimum: 1
                type: integer
              resources:
                description: Resources defines the resource requirements for the MCP
                  server container
                properties:
                  limits:
                    description: Limits describes the maximum amount of compute resources
                      allowed
                    properties:
                      cpu:
                        description: CPU is the CPU limit in cores (e.g., "500m" for
                          0.5 cores)
                        type: string
                      memory:
                        description: Memory is the memory limit in bytes (e.g., "64Mi"
                          for 64 megabytes)
                        type: string
                    type: object
                  requests:
                    description: Requests describes the minimum amount of compute
                      resources required
                    properties:
                      cpu:
                        description: CPU is the CPU limit in cores (e.g., "500m" for
                          0.5 cores)
                        type: string
                      memory:
                        description: Memory is the memory limit in bytes (e.g., "64Mi"
                          for 64 megabytes)
                        type: string
                    type: object
                type: object
              secrets:
                description: Secrets are references to secrets to mount in the MCP
                  server container
                items:
                  description: SecretRef is a reference to a secret
                  properties:
                    key:
                      description: Key is the key in the secret itself
                      type: string
                    name:
                      description: Name is the name of the secret
                      type: string
                    targetEnvName:
                      description: |-
                        TargetEnvName is the environment variable to be used when setting up the secret in the MCP server
                        If left unspecified, it defaults to the key
                      type: string
                  required:
                  - key
                  - name
                  type: object
                type: array
              transport:
                default: stdio
                description: Transport is the transport method for the MCP server
                  (stdio or sse)
                enum:
                - stdio
                - sse
                type: string
              volumes:
                description: Volumes are volumes to mount in the MCP server container
                items:
                  description: Volume represents a volume to mount in a container
                  properties:
                    hostPath:
                      description: HostPath is the path on the host to mount
                      type: string
                    mountPath:
                      description: MountPath is the path in the container to mount
                        to
                      type: string
                    name:
                      description: Name is the name of the volume
                      type: string
                    readOnly:
                      default: false
                      description: ReadOnly specifies whether the volume should be
                        mounted read-only
                      type: boolean
                  required:
                  - hostPath
                  - mountPath
                  - name
                  type: object
                type: array
            required:
            - image
            type: object
          status:
            description: MCPServerStatus defines the observed state of MCPServer
            properties:
              conditions:
                description: Conditions represent the latest available observations
                  of the MCPServer's state
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              message:
                description: Message provides additional information about the current
                  phase
                type: string
              phase:
                description: Phase is the current phase of the MCPServer
                enum:
                - Pending
                - Running
                - Failed
                - Terminating
                type: string
              url:
                description: URL is the URL where the MCP server can be accessed
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
